<%- model_class = Calculation -%>
<div class="page-header">
  <h1><%=t '.title', :default => "Исходные данные" %></h1>
</div>

<div class="dl-horizontal">
  <div><strong><%= "Название схемы" %> : </strong><%= @calculation.name %></div>
  
  <div><strong><%= "Полная масса автомобиля" %> : </strong> <%= @calculation.mass_avto %></div>
  
  <div><strong><%= "Колея автомобиля" %> : </strong> <%= @calculation.col_avto %></div>
 
  <div><strong><%= "Высота автомобиля"%> : </strong><%= @calculation.height_avto %></div>

  <div><strong><%= "Коэфициент аэродинамического сопротивления" %> : </strong><%= @calculation.k_air_sopr %></div>

  <div><strong><%=  "Ширина профиля шины" %> : </strong><%= @calculation.shin_wide %></div>
  
  <div><strong><%= "Высота профиля шины" %> : </strong><%= @calculation.shin_height %></div>
  
  <div><strong><%= "Посадочный диаметр" %> : </strong><%= @calculation.sit_diam %></div>
  
  <div><strong><%="Максимальная мощность двигателя" %> : </strong><%= @calculation.n_e_max %></div>

  <div><strong><%= "Максимальный момент двигателя" %> : </strong><%= @calculation.m_e_max %></div>
 
  <div><strong><%= "Обороты двигателя при максимальной мощности" %> : </strong><%= @calculation.n_N %></div>
  
  <div><strong><%= "Обороты двигателя при максимальном моменте" %> : </strong><%= @calculation.n_m %></div>
  
  <div><strong><%= "Минимальные обороты двигателя" %> : </strong><%= @calculation.n_min %></div>
 
  <div><strong><%= "Максимальные обороты двигателя" %> : </strong><%= @calculation.n_k %></div>
 
  <div><strong><%= "Потери на навесное оборудование" %> : </strong><%= @calculation.nu_b %></div>
  
  <div><strong><%= "К.П.Д. трансмиссии" %> : </strong><%= @calculation.nu_t %></div>
 
  <div><strong><%= "Передадочное число главной передачи" %> : </strong><%= @calculation.uo %></div>

  <div><strong><%= "Количество передач" %> : </strong><%= @calculation.n %></div>

  <div><strong><%= "Передадочное число 1 передачи" %> : </strong><%= @calculation.uk1 %></div>

  <div><strong><%= "Передадочное число 2 передачи"%> : </strong><%= @calculation.uk2 %></div>

  <div><strong><%= "Передадочное число 3 передачи"%> : </strong><%= @calculation.uk3 %></div>

  <div><strong><%=  "Передадочное число 4 передачи"%> : </strong><%= @calculation.uk4 %></div>

  <div><strong><%= "Передадочное число 5 передачи" %> : </strong><%= @calculation.uk5 %></div>
 
  <div><strong><%= "Передадочное число 6 передачи" %> : </strong><%= @calculation.uk6 %></div>
  
  <div><strong><%= "Передадочное число 7 передачи" %> : </strong><%= @calculation.uk7 %></div>

  <div><strong><%= "Передадочное число 8 передачи" %> : </strong><%= @calculation.uk8 %></div>

  <div><strong><%= "Передадочное число 9 передачи" %> : </strong><%= @calculation.uk9 %></div>

  <div><strong><%= "Передадочное число 10 передачи" %> : </strong><%= @calculation.uk10 %></div>

  <div><strong><%= "Передадочное число 11 передачи" %> : </strong><%= @calculation.uk11 %></div>

  <div><strong><%= "Передадочное число 12 передачи" %> : </strong><%= @calculation.uk12 %></div>

  <div><strong><%=  "Передадочное число 13 передачи"%> : </strong><%= @calculation.uk13 %></div>

  <div><strong><%=  "Передадочное число 14 передачи"%> : </strong><%= @calculation.uk14 %></div>
 
  <div><strong><%= "Передадочное число 15 передачи" %> : </strong><%= @calculation.uk15 %></div>

  <div><strong><%= "Коэфициент сопротивления дороги" %> : </strong><%= @calculation.kroad %></div>

</div>

 <h1><%=t '.title', :default => "Расчеты" %></h1>

  <br/>
<div class="dl-horizontal">
  <div><strong><%= "Момент максимальной мощности (Mn)" %> : </strong><%=mn=@calculation.n_e_max*1000.0/(@calculation.n_N*2*Math::PI/60.0)  %> Н*м</div>

 <% x=(@calculation.n_m+0.0)/@calculation.n_N %>
 <% k=@calculation.m_e_max/mn %>
 <% c = (1-k)/(2*x-(x*x)-1)   %>  
<div><strong><%= "Коэфициент а" %> : </strong><%= a = k-c*x*x   %></div> 

<div><strong><%= "Коэфициент b" %> : </strong><%= b = 2*c*x   %></div> 

<div><strong><%= "Коэфициент с" %> : </strong><%= c   %></div> 


</div>
 <br/>
 <%ne = Array.new%>
 <%pNe = Array.new%>
 <%nE = Array.new%>
 <%pMe = Array.new%>
 <%me = Array.new%>
  <% for i in 0..70 %>
   <strong><%="ne(#{i})"%> : </strong><%=ne[i]=((600)+i*(((1.05*@calculation.n_N)-600)/70))*2*Math::PI/60.0%>
    <%x=(ne[i]/(@calculation.n_N*2*Math::PI/60.0))%>
   <strong><%="N'e(ne)"%> : </strong><%=pNe[i]=@calculation.n_e_max*(a*x+b*x*x-c*x*x*x)%>
   <strong> <%="Ne(ne)%"%> : </strong><%=nE[i]=pNe[i]*@calculation.nu_b%>
   <strong> <%="M'e(ne)"%> : </strong><%=pMe[i]=pNe[i]*735.49875/(ne[i])%>
   <strong> <%="Me(ne)"%>  : </strong><%=me[i]=nE[i]*735.49875/(ne[i])%>
    <br/>
  <%end%>

  <br/>
<%g = Gruff::Line.new%>
<%g.title = "My Graph" %>
<%g.data("N'e(ne)", pNe)%>
<%g.data("Ne(ne)", nE)%>
<%g.data("M'e(ne)", pMe)%>
<%g.data("Me(ne)", me)%>
<%g.labels = {0 => '0', 20 => '20', 40 => '40', 60 => '60', 80 => '70'}%>
<%g.write('public/images/my_fruity_graph.png')%>
<br/>
<img alt="Sample App" class="round" src="/images/my_fruity_graph.png" />
<br/> 

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              calculations_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_calculation_path(@calculation), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              calculation_path(@calculation),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
</div>
